function [K_hat, x_hat] = GH_Data_Species_Concentrations (mu_1, mu_2, T, S, H, K_test, y_hat, x_test)
   %-----------------------------------------------------------------------
   t_1 = 0:T/mu_1:T;
   %-----------------------------------------------------------------------
   N_1 = mu_1 + 1; 
   %-----------------------------------------------------------------------
   t_2 = 0:T/mu_2:T;
   %-----------------------------------------------------------------------
   N_2 = mu_2 + 1;
%--------------------------------------------------------------------------  
[s,~] = size(S);
%--------------------------------------------------------------------------
q = numel(K_test);
%--------------------------------------------------------------------------
Index = zeros(1,N_1);
for i = 1:N_1
    for j = 1:N_2
        if t_1(i) == t_2(j)
           Index(i) = j; 
        end
    end
end
%--------------------------------------------------------------------------
x_test(x_test == 0) = 10^(-5);
%--------------------------------------------------------------------------
theta_test = K_test';
for i = 1:s
    theta_test = [theta_test, x_test(i,:)];
end
%--------------------------------------------------------------------------
e_1 = @(theta)GH_Objective_1(q, theta, Index, H, S, mu_2, T, y_hat);
%--------------------------------------------------------------------------
theta_hat = fminsearch(e_1,theta_test);
%--------------------------------------------------------------------------
K_hat = theta_hat(1:q)';
%--------------------------------------------------------------------------
for i = 1:s
    x_hat(i,:) = theta_hat(q+(i-1)*N_1+1:q+i*N_1)';
end
%--------------------------------------------------------------------------
x_hat(x_hat==0) = realmin;
end
